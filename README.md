# ZJU-数据要素处理基础
课程综合实践II的笔记（including lab, homework, and final project）

## I.Introduction

这是浙江大学课程综合实践II的数据要素处理基础课程的学习笔记，主要的笔记由typst书写。

本课程包括12讲（其中第11次为来自芝加哥大学的徐海峰老师的特邀讲座，第12次后半部分为期末测试），两次homework和两次lab以及最后的Final Project。

可以参考课程网站：https://yhwu-is.github.io/Teach/ec/data_market/2025/

## II. Lecture Note Introduction

以下是各讲的Lecture Note 以及Abstract(Abstract部分由ChatGPT-o4 mini high生成)

#### Lecture 01:数据要素市场概述

**Abstract**:本讲通过循环流量图模型，概述家庭与企业在商品与生产要素市场中的双向交易机制及要素流向。在传统生产要素方面，梳理了土地、劳动力、资本和企业家才能（或技术）四大要素的定义、特征及价格机制。在此基础上，将数据定位为数字经济时代的新型生产要素，分析其零成本复制性、价值不确定性等独特属性及相应定价挑战。进一步探讨了数据流通的社会意义和市场化定价机制的重要作用，并比较了成本法、收益法与市场法三种定价策略及其优劣。本讲还介绍了数据市场的分类（原始数据、查询数据、模型数据）和数据收集、存储、产品化、合规、定价、溯源与销毁等主要交易环节。同时引入比较优势、边际效用与“看不见的手”理论，说明专业化贸易在数据要素上的应用价值。最后，从产权界定、公平分配和隐私保护三方面提出数据市场设计的核心要求，为后续深入研究定价模型与合规技术奠定基础。

#### Lecture 02:数据合规与安全

**Abstract**:本文围绕数据要素交易基础中的合规与安全技术展开论述，首先引入安全多方计算的原理，以Yao百万富翁问题为例，详细说明了加密与随机化方案在双方隐私信息比较中的应用流程及安全性保障；随后介绍联邦学习的整体架构与优势场景，阐释了在分布式计算环境下实现模型参数协同更新的要素及潜在隐私泄露风险；在数据脱敏部分，本文分别对动态脱敏与静态脱敏场景下的应用需求进行了分析，系统归纳了无效化、随机值替换、数据替换、对称加密、平均值处理、偏移与取整等若干常用脱敏算法，并探讨了数据脱敏的总体架构及多项脱敏标准；接着聚焦差分隐私，结合数学模型与Laplace机制，剖析了隐私参数ε与查询敏感度对统计结果准确度与隐私保护强度的制衡关系；在全同态加密部分，论述了其在密文域内支持加法与乘法运算的独特优势与高昂计算成本；随后深入零知识证明技术，分别比较了交互式零知识证明、zk-SNARKs 与 zk-STARKs 在证明效率、可扩展性与透明性方面的差异，并指出其在匿名身份认证、区块链扩容等应用场景中的发展前景与挑战；最后结合上述技术，从法律合规与技术实施两个维度对数据交易市场的设计原则进行了简要梳理，为构建可审计、可追溯、可赋能的数据要素流通体系提供了理论依据。本讲通过技术与合规双轮驱动，为数据要素价值实现与风险防控提供了全面视角与方法论。

#### Lecture 03:非合作博弈基础（一）

**Abstract**:本文第三讲在微观经济学基础之上，系统引入非合作博弈论的基本概念与分析工具。首先回顾了消费者偏好与效用函数的定义，阐述柯布—道格拉斯、冯·诺依曼—摩根斯坦及拟线性效用等典型形式，并通过冰激凌例子说明边际效用递减规律及预算法约束下的效用最大化问题，进而引出需求定律、供给定律与市场出清、社会福利及市场失灵（垄断、外部性、公共物品与信息不对称）的核心思想，奠定数据要素交易的微观分析框架。随后，讲解了博弈论的起源与范畴，将单人最优化推广至多主体战略互动，以策略式博弈三元组形式描述参与者、策略集及报酬函数，并区分静态／动态、完全／不完全信息博弈及合作／非合作博弈。重点介绍占优策略与占优策略均衡，包括严格占优与弱占优的定义及重复剔除劣策略的方法，以及囚徒困境等典型案例；在此基础上，详细推导纳什均衡的概念及判定准则，并通过古诺寡头产量竞争模型求解连续策略下的均衡产量。最后，概述了纯策略与混合策略纳什均衡存在性证明的思路，涉及布劳威尔不动点定理与斯珀纳引理等数学工具，为后续深入研究博弈解的性质与演化博弈机制设计奠定了理论基础。

#### Lecture 04:非合作博弈基础（二）

**Abstract**:本讲继续非合作博弈论基础，第一部分聚焦混合策略纳什均衡，系统阐述混合策略与混合扩展的概念，推导收益函数的期望表达式，并借助石头剪刀布与夫妻周末活动博弈案例，示范最优反应法与无差异原则的均衡计算过程，讨论有限策略博弈中混合策略均衡的存在性（纳什定理）及其 PPAD 完全性带来的计算复杂度挑战。第二部分引入完全信息动态博弈，以扩展式博弈的树状结构为基础，定义子博弈完美均衡，说明逆向归纳法的求解思想，并通过斯塔克尔伯格产量领导—跟随者模型，演示领导者根据跟随者最优反应函数进行双层优化的均衡推导。第三部分拓展至不完全信息博弈，以行业进入模型为例，构建类型空间与先验分布，介绍事前、事中、事后三阶段的信息结构，给出贝叶斯纳什均衡的定义和求解步骤，结合低高成本参与人的混合策略计算，说明后验概率更新与均衡选择原则。全篇由静态博弈到动态博弈再到不完全信息博弈，兼顾理论推导与案例应用，为数据要素交易与经济决策提供了完整的博弈论方法框架。

#### Lecture 05:合作博弈与数据估值

**Abstract**:本讲第五章深入探讨了合作博弈理论及其在数据估值中的应用。首先，从非合作博弈的纳什均衡自然过渡至具有可转移效用（TU）的合作博弈模型，形式化定义了有限参与者集合$N$与特征函数$v$，并通过“分摊美元”博弈示例直观展示不同联盟（coalition）的价值及多重解概念视角。继而，讲解合作博弈的核心（Core），明确效率性（全体收益分配完毕）与联盟理性（任意子联盟收益不低于自主成盟）两大约束，并通过实例论证核可能为空集的情形。

随后，重点介绍沙普利值（Shapley value）的公理化推导：基于效率、公平对称、零贡献者与加性四大性质给出其唯一性定义，进而通过排列数与边际贡献的等价公式，为个体在所有可能加入顺序中的平均边际贡献提供理论测度。结合机器学习模型性能评价，引入留一法（Leave-One-Out）直观衡量单点数据集对总效用的增益，并在此基础上提出Data-Shapley，将Shapley框架应用于数据集估值。针对实际计算效率与鲁棒性需求，进一步发展了Beta-Shapley（对不同规模子集赋予可调权重）与Data-Banzhaf（均匀随机扰动下的平均贡献）两种优化方案。

讲义还系统分析了各方法的计算复杂度，指出数据Shapley及其变体属于 \# P 完全问题，需通过蒙特卡洛采样进行近似计算，并比较了不同近似策略的适用场景。最后，扩展至动态Shapley值，分别给出在数据增补与删除场景下的增量与减量价值更新公式，并探讨其高效实现方法。本讲将合作博弈核心理论与前沿数据价值评估方法紧密结合，为数字经济时代的数据要素定价与流通设计提供了系统化的理论工具与实践思路。

#### Lecture 06:多臂老虎机算法基础与应用

**Abstract**:第六讲围绕多臂老虎机（Multi-Armed Bandit，MAB）问题展开，分为三大模块。第一部分介绍随机多臂老虎机的基础：从识别式学习与决策式学习的差异入手，给出MAB模型及伪遗憾和期望遗憾的定义，并运用Hoeffding不等式构建奖励估计的置信区间；随后依次讲解贪心算法、$\epsilon$-贪心算法、上置信界（UCB1）与汤普森采样（Thompson Sampling）的策略流程与次线性遗憾界结果。第二部分聚焦对抗性多臂老虎机：建立在线对抗模型并以固定行动基准重新定义遗憾，说明确定性策略会导致线性遗憾，进而引入随机化的必要性；重点推导乘性权重更新（MWU）算法及其Hedge、Exp3扩展，通过分析权重下降与期望代价的关系，证明算法可实现O(√T ln n)级别的无悔性保证。第三部分探讨MAB在数据市场与在线定价中的应用：以动态定价为例，分析二分搜索法的遗憾上界，并提出保守探索的改进算法，将遗憾优化至O(log log N)；同时简要展望MAB在推荐系统、投资组合与数据采集等场景的应用前景。本讲通过理论推导、算法比较与案例演示，为数字经济时代的数据要素交易与在线决策优化提供了系统化的方法框架和实践指导。

#### Lecture 07:拍卖与机制设计基础

**Abstract**:第七讲“拍卖与机制设计基础”系统分为三个部分：
首先介绍出售物品的两种基本方式——公布价格与拍卖，并对英式拍卖、荷式拍卖、密封一价拍卖和密封二价拍卖等常见形式，从投标规则、交易规则与信息规则三方面进行分类与比较。
其次在单物品密封拍卖的不完全信息静态博弈框架下，形式化描述买家估值、分配与支付规则，重点分析第二价格拍卖中的诚实报价占优策略性质，以及第一价格拍卖的贝叶斯纳什均衡推导示例；并通过收入等价定理说明在独立同分布估值假设下，一价与二价拍卖对卖家期望收入无差异，还讨论了估值相互依赖、合谋竞标等博弈复杂性问题。
最后引入机制设计基本原理，定义直接显示机制与激励相容性，阐述显示原理（revelation principle）如何将任意机制归约为诚实报告类型的直接机制；基于迈尔森引理给出占优策略激励相容（DSIC）拍卖机制的分配单调性与支付唯一性条件；并详细介绍维克里–克拉克–格罗夫斯（VCG）机制的分配与支付规则，证明其在保证事后效率、个人理性与非负支付的基础上实现社会福利最大化，同时指出VCG在多物品竞拍与计算复杂性上的局限。该讲为数字经济时代的拍卖机制设计与最优机制构造提供了坚实的理论工具

#### Lecture 08:最优机制

**Abstract**:第八讲系统阐述了单物品拍卖中最优机制设计的完整思路与方法。首先，构建了卖家与 $n$ 位买家、各自估值服从已知先验分布的基本模型，并在此基础上引入贝叶斯激励相容（BIC）的迈尔森引理，推导出期望分配概率单调性与期望支付函数与分配概率的一致性关系；随后，结合个人理性（IR）与分配规范性，给出了合理机制的等价条件。通过一系列积分变换与目标函数重写，将卖家期望收入最大化问题转化为“虚拟福利最大化”问题，其中虚拟估值函数 $c_i(t_i)=t_i-\frac{1-F_i(t_i)}{f_i(t_i)}$ 成为核心量。

在正则化条件（虚拟估值单调递增）下，分配机制的最优解是在每个估值向量 $\mathbf t$ 上，将物品赋予具有最大且非负虚拟估值的买家，并以其临界报价作为付款；支付规则则由迈尔森积分公式确定。对于独立同分布且满足正则性的对称模型，最优机制退化为带保留价的二价拍卖，其中保留价等于虚拟估值函数为零时的反函数值；以\[0,1]均匀分布为例，保留价为 $\tfrac12$。

最后，讲义展望了最优机制在数据要素交易中的应用，包括机器学习模型拍卖（将模型准确率作为可分配资源）、无先验拍卖的竞争比分析，以及结合差分隐私的指数机制设计，探讨了如何在满足近似诚实性与隐私保护的前提下，实现机制的近似最优与有效率性。本讲为后续高阶机制设计与数据定价研究提供了坚实的理论框架与方法论。

#### Lecture 09:数据定价基础

**Abstract**:第九讲围绕“数据定价基础”问题展开，内容可分为四个层面：
首先，勾勒数据交易的整体框架与参与角色，明确数据服务方、中介机构、数据提供者与数据使用者在数据收集、合规、安全、产品化及收益分配中的职责，提出“预算平衡”“个人理性”“无嫉妒”等定价基本要求，以保障市场稳定运行与参与者公平收益；
其次，探讨数据产品的版本化策略与无套利原则，介绍免费数据、按调用计费、打包定价、订阅制及免费增值等主流模式，阐明原始数据、查询结果与机器学习模型等不同数据要素的版本划分方法，并给出信息无套利与组合无套利的严格数学定义；
第三，针对查询数据定价，构建支撑集与冲突集模型，将查询向量映射为对应冲突集，证明定价函数在满足单调性与次可加性时即可实现无套利，并在已知买家估值的假设下，将利润最大化问题转化为超图结构上的最优单调次可加集合函数设计；
最后，聚焦机器学习模型定价的无套利架构，引入基于ε-差分隐私的补偿函数与Data-Shapley覆盖率等效用指标，结合模型买方对准确度与隐私预算的双重需求，在多版本选择中兼顾公平分配、无套利、成本最小化与社会福利最大化目标。
本讲为数字经济时代的数据要素定价提供了系统化的理论框架与可行的实践路径，为后续深入模型定价算法与市场机制设计奠定了坚实基础。

#### Lecture 10:贝叶斯劝说

**Abstract**:本文第十讲聚焦贝叶斯劝说（Bayesian Persuasion）理论与方法，首先通过导师为学生写推荐信的经典案例，直观说明信号发送者（导师）如何通过信号机制影响信号接收者（企业）的决策，并形式化定义信号机制、先验分布与后验分布之间的贝叶斯更新关系。随后，介绍模型的基本构成：信号承诺、状态抽样、信号发送、接收者决策与效用实现等五个步骤，并将最优信号机制设计的问题转化为在满足贝叶斯可行性约束下对后验分布分布的优化。接着，阐述显示原理（Revelation Principle）如何将信号空间规模缩减至接收者行动数，从而简化了设计复杂度，并引入凹包络（Concave Closure）概念证明最优效用等于先验点处的凹包络值。通过对推荐信例子的实证分析，验证了部分诚实推荐方案的最优性，并展示了线性规划表述使得计算更加直接可行。最后，讨论了信号机制对接收者的影响，证明任何信号都不会降低接收者在无信息情况下的期望效用，为后续在数据要素交易与机制设计中融入贝叶斯劝说提供了理论基础与实践指南。

## III.Lab介绍

#### Lab 1:Shaply值计算

##### 实验总体结构

整个实验围绕两个核心任务展开，并提供了三种不同的合作博弈场景进行测试：

1.  **实现精确计算算法**：您需要在 `exactSV.py` 文件中，根据联盟式（coalition-based）公式，编写代码来精确计算每个参与者的 Shapley 值。
2.  **实现近似计算算法**：您需要在 `mcSV.py` 文件中，实现基于蒙特卡洛采样的近似算法，该算法在参与者数量非常多时特别有用。
3.  **验证与分析**：使用 `homework.ipynb` 来运行您实现的代码，并与提供的“标准答案”（Ground Truth）进行比较，验证算法的正确性和近似算法的收敛性。

##### 实验涉及的博弈场景

实验提供了三种不同的合作博弈游戏，这些游戏被封装在 `game.py` 中，您无需关心其内部实现，只需调用 `game.get_utility(coalition)` 即可获得一个联盟的价值。
* **Airport (机场问题)**：一个经典的合作博弈问题。多个不同大小的飞机需要使用同一个机场跑道，跑道建设成本需要根据每个飞机（玩家）的需求进行分摊。玩家的 Shapley 值代表了他/她应该分摊的成本。
* **Voting (投票问题)**：模拟一个加权投票系统。每个玩家拥有一定数量的票数，联盟的价值取决于其总票数是否超过半数从而赢得投票。玩家的 Shapley 值代表了其在投票系统中的“权力”或影响力。
* **Iris (鸢尾花分类)**：这是一个与机器学习模型可解释性相关的任务。在这里，“玩家”是训练数据集中的每一个数据点，“联盟”是由某些数据点组成的子集，“联盟的价值”则是用这个数据子集训练出的分类模型在测试集上的准确率。一个数据点的 Shapley 值衡量了它对最终模型性能的贡献大小。

###### 任务一：补全 `exactSV.py`（精确计算）

* **目标**：根据 `homework.ipynb` 中给出的公式，精确计算 Shapley 值：
    $$SV_i = \sum_{S \subseteq N \setminus \{i\}} \frac{|S|!(n - |S| - 1)!}{n!} (u(S \cup \{i\}) - u(S))$$
* **实现思路**：
    1.  **遍历玩家**：最外层循环遍历每一个玩家 `i`，因为我们要为每个玩家单独计算其 Shapley 值。
    2.  **遍历子联盟**：对于当前的玩家 `i`，需要遍历所有**不包含他/她**的子联盟 `S`。
    3.  **计算边际贡献**：对于每一个这样的子联盟 `S`，计算玩家 `i` 加入后带来的价值增量，即边际贡献：`u(S U {i}) - u(S)`。
    4.  **计算权重**：边际贡献需要乘以一个组合权重系数，这个系数取决于子联盟 `S` 的大小。权重为 `|S|! * (n - |S| - 1)!`。
    5.  **累加**：将所有加权后的边际贡献累加起来。
    6.  **归一化**：最后，将累加的总和除以 `n!`，得到玩家 `i` 最终的 Shapley 值。
* **性能优化**：直接实现上述思路会导致大量的重复计算。一个高效的方法是：
    * **预计算**：提前计算并缓存所有可能联盟（$2^n$个）的效用值 `u(S)` 和所有需要的阶乘 `k!`。
    * **查表计算**：在主循环中，直接从缓存中读取效用值，而不是反复调用 `game.get_utility()`。这能极大地提升算法在大玩家数量（如 n=20）下的运行速度，使其能在合理时间内完成。

###### 任务二：补全 `mcSV.py`（蒙特卡洛近似）

* **目标**：通过随机采样玩家排列的方式来估算 Shapley 值。`homework.ipynb` 指出可以仿照 `naiveSV.py` 的逻辑。
* **实现思路**：精确算法之所以慢，是因为它需要考虑 `n!` 种玩家排列。蒙特卡洛法的思路就是“以偏概全”，通过随机抽取足够多的排列来近似整体情况。
    1.  **采样循环**：代码的外层是一个循环，其迭代次数 `n_samples` 由总采样预算 `total_sample_budget` 决定。
    2.  **生成随机排列**：在每次循环开始时，通过 `np.random.shuffle(indexes)` 生成一个随机的玩家进入顺序（排列）。
    3.  **计算边际贡献**：对于这个随机排列，像 `naiveSV.py` 中一样，从前到后依次让玩家加入联盟，并计算每个玩家加入时的**边际贡献**。
        * 例如，对于排列 `[p3, p1, p2]`：
            * p3 的贡献是 `u({p3}) - u({})`
            * p1 的贡献是 `u({p3, p1}) - u({p3})`
            * p2 的贡献是 `u({p3, p1, p2}) - u({p3, p1})`
    4.  **累加贡献**：将本次采样中计算出的每个玩家的边际贡献，累加到该玩家的总贡献变量 `sv` 上。
    5.  **求平均**：当所有采样循环结束后，将每个玩家的总贡献 `sv[i]` 除以总的采样次数 `n_samples`，就得到了该玩家的 Shapley 值近似值。

##### 实验的验证流程

`homework.ipynb` 为您提供了一个完整的验证流程：
1.  **代码填充**：您将上述思路转化为代码，填充到 `exactSV.py` 和 `mcSV.py` 的指定位置。
2.  **运行与比对**：在 Notebook 中运行测试代码块。这些代码块会自动调用您实现的函数，计算 Shapley 值，然后从 `groundTruth` 文件夹加载标准答案，最后输出您的结果与标准答案的比对以及一个“准确率”。
3.  **扩展性与收敛性分析**：
    * 对于精确算法，`n=20` 的测试检验了您代码的性能。
    * 对于近似算法，最后的绘图部分展示了随着采样次数的增加，计算结果的均方误差（MSE）逐渐下降的趋势，直观地证明了算法的收敛性。

#### Lab 2:零和博弈

##### 实验总体介绍

在一个双人零和博弈中，行玩家和列玩家在一个收益矩阵 `A` 上进行博弈。如果行玩家采取策略 `x`，列玩家采取策略 `y`，那么行玩家的收益是 $x^T A y$，而列玩家的收益正好相反，为 $-x^T A y$。实验的目标就是找出一种稳定的策略组合 (x, y)，即纳什均衡点，此时任何一方都没有动机单方面改变自己的策略。

项目文件结构清晰，`dataset` 文件夹包含了“石头剪刀布”和随机生成的博弈矩阵，`homework.ipynb` 是主运行文件，而 `support.py`、`mwu_solver.py` 和 `nash_verifier.py` 是你需要完成编码的三个核心文件。

##### 需要自己实现的部分及思路

###### 任务一：纳什均衡检验器 (`nash_verifier.py`)

这是整个实验的基础，用于验证后续两种方法算出的解是否正确。

* **核心思路**：根据纳什均衡的定义，一个策略组合 $(X, Y)$ 是纳什均衡，意味着在对方策略（例如 $Y$）不变的情况下，本方（行玩家）采取的策略 $X$ 带来的收益，不应低于采取任何其他单一纯策略 $e_i$ 的收益。对列玩家同理。
* **实现方法**：
    1.  **行玩家检查**：
        * 计算行玩家在当前策略组合 $(X, Y)$ 下的期望收益：`payoff_A = X^T @ M @ Y`。
        * 计算在列玩家策略 $Y$ 固定的情况下，行玩家分别采取每一种纯策略 $e_i$（即只出第i招）能获得的收益，这会得到一个收益向量 `row_pure_payoffs = M @ Y`。
        * 找出这个向量中的最大值，即行玩家可能获得的最大收益 `max_payoff = np.max(row_pure_payoffs)`。
        * 比较 `payoff_A` 和 `max_payoff`。如果两者在一定误差范围内不相等，说明行玩家有更好的选择（可以单方面换策略提高收益），因此当前不是纳什均衡。
    2.  **列玩家检查**：
        * 逻辑完全相同，但要注意列玩家的目标是最小化行玩家的收益（等价于最大化自己的收益 $-x^T A y$）。
        * 计算列玩家当前期望收益：`payoff_B = - (X^T @ M @ Y)`。
        * 计算列玩家采取每种纯策略的收益向量：`col_pure_payoffs = - (X^T @ M)`。
        * 找出最大值并与 `payoff_B` 比较。
    3.  只有当双方的检查都通过时，函数才返回 `True`。

###### 任务二：通过枚举支撑集精确求解 (`support.py`)

这是一种精确但计算量巨大的方法。它基于一个重要结论：在纳什均衡状态下，玩家只会以正概率使用那些能为他带来最大期望收益的纯策略。这些策略的集合被称为“支撑集”（Support Set）。

* **核心思路**：通过暴力枚举双方所有可能的支撑集组合 $(S_1, S_2)$，然后对每一种组合，将问题转化为一个线性可行性问题（Linear Feasibility Problem）来求解。
* **实现方法**：你需要构建一系列线性的等式和不等式约束。
    * **变量**：行、列玩家的策略向量 $x_1^*, x_2^*$ 和他们的期望收益 $U_1, U_2$。
    * **等式约束**：
        1.  概率归一化：$x_1^*$ 和 $x_2^*$ 的所有元素之和必须为 1。
        2.  支撑集内收益相等：对于行玩家支撑集 $S_1$ 内的任意策略 $i$，其期望收益 $\sum_{j} u_1(i,j) x_2^*(j)$ 必须等于 $U_1$。列玩家同理。
        3.  支撑集外概率为零：对于所有不在支撑集 $S_1$ 内的策略 $i$，其概率 $x_1^*(i)$ 必须为 0。
    * **不等式约束**：
        1.  支撑集外收益更低：对于行玩家支撑集 $S_1$ 外的任意策略 $i$，其期望收益 $\sum_{j} u_1(i,j) x_2^*(j)$ 必须小于或等于 $U_1$。列玩家同理。
        2.  概率非负：所有策略的概率必须大于等于 0。
    * 将这些约束转化为 `scipy.optimize.linprog` 函数所需的 `A_eq`, `b_eq`, `A_ub`, `b_ub` 矩阵形式，然后调用求解器。如果求解器找到了一个可行解，就用任务一的检验器验证它，通过后就加入到结果列表中。

###### 任务三：使用 MWU 算法近似求解 (`mwu_solver.py`)

这是一种更高效的在线学习算法，用于近似求解纳什均衡。实验采用了一种对抗性设置，让算法收敛得更快。

* **核心思路**：让一个玩家（列玩家）成为“学习者”，另一个玩家（行玩家）成为“对抗者”。学习者通过 MWU 算法不断更新自己的策略，而对抗者在每一轮都采取能最大化自己收益（即让学习者成本最高）的最优反应。经过足够多的迭代，双方的平均策略会收敛到纳什均衡。
* **实现方法**：在 `find_equilibrium` 函数的循环中实现以下逻辑：
    1.  **列玩家（学习者）计算策略**：根据当前的权重向量 `w_col`，计算出本轮的混合策略 `y`。策略 `y` 是 `w_col` 归一化的结果：$y_i = w_i / \sum_j w_j$。
    2.  **行玩家（对抗者）选择最优反应**：计算行玩家的每种纯策略在面对列玩家策略 `y` 时的期望收益 (`payoffs = M @ y`)，然后选择收益最大的那个策略作为本轮的行动 `x` (这是一个 one-hot 向量)。
    3.  **计算 Cost**：对于列玩家，行玩家的收益就是他的成本。因此，成本向量 `cost` 就是行玩家采取策略 `x` 时，列玩家分别出每一招所导致的行玩家收益，即 `cost = x @ M`。
    4.  **列玩家更新权重**：根据乘法更新规则，用成本来惩罚权重：$w_i^{(t + 1)} = w_i^{(t)} \times (1 - \epsilon \times \text{cost}_i^{(t)})$。$\epsilon$ 是学习率。
    5.  **最终策略**：循环结束后，列玩家的策略 `y` 就是其最终收敛的策略。而行玩家的均衡策略，则是他在所有迭代中选择过的纯策略的平均值，即 `np.mean(row_strategy_history, axis=0)`。
