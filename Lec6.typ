#set document(
  title: "æ•°æ®è¦ç´ äº¤æ˜“åŸºç¡€",
  author: "forliage",
)

// --- é¡µé¢ä¸å­—ä½“è®¾ç½® ---
#set page(
  paper: "a4",
  margin: (x: 2.5cm, y: 2.2cm),
  // é¡µçœ‰ï¼šæ˜¾ç¤ºè¯¾ç¨‹æ ‡é¢˜
  header: align(center)[
    #text(10pt, fill: gray)[æ•°æ®è¦ç´ äº¤æ˜“åŸºç¡€]
    #line(length: 100%, stroke: 0.5pt + gray)
  ],
  // é¡µè„šï¼šæ˜¾ç¤ºé¡µç 
  //footer: align(right)[#counter(page)]
)

// è®¾ç½®ä¸­è‹±æ–‡åŸºç¡€å­—ä½“ï¼Œä¿è¯è·¨å¹³å°å…¼å®¹æ€§
// å¦‚æœä½ æœ‰ç‰¹å®šçš„å­—ä½“ï¼Œå¯ä»¥æ›¿æ¢ "New Computer Modern" å’Œ "Noto Serif CJK SC"
// æ¯”å¦‚ Windows ç”¨æˆ·å¯ä»¥ä½¿ç”¨ "STSong" "SimSun" ç­‰
#set text(
  font: ("New Computer Modern", "Noto Serif CJK SC"),
  size: 11pt,
  lang: "zh",
)


// --- é¢œè‰²å®šä¹‰ ---
#let primary_color = rgb("#007A7A") // æ·±é’è‰² (Teal)
#let accent_color = rgb("#FFB81C")  // äº®é»„è‰² (Amber)
#let text_color = rgb("#333333")    // æ·±ç°è‰²
#let bg_color = rgb("#F5F7F7")      // ææµ…çš„èƒŒæ™¯ç°

#set text(fill: text_color)

// --- æ ‡é¢˜æ ·å¼å®šä¹‰ ---
// ä¸€çº§æ ‡é¢˜
#show heading.where(level: 1): it => {
  v(1.8em, weak: true) // æ ‡é¢˜å‰çš„å‚ç›´é—´è·
  let title_text = text(18pt, weight: "bold", primary_color, it.body)
  [
    #title_text
    #line(length: 100%, stroke: 1pt + primary_color)
  ]
  v(1em, weak: true) // æ ‡é¢˜åçš„å‚ç›´é—´è·
}

// äºŒçº§æ ‡é¢˜
#show heading.where(level: 2): it => {
  v(1.2em, weak: true)
  // åœ¨æ ‡é¢˜å‰åŠ ä¸€ä¸ªè£…é¥°æ€§çš„æ–¹å—
  rect(width: 6pt, height: 6pt, fill: accent_color)
  h(6pt)
  text(14pt, weight: "bold", it.body)
  v(0.6em, weak: true)
}

// --- è‡ªå®šä¹‰ç¬”è®°æ¨¡å— ---

// å®šä¹‰æ¨¡å—
#let definition(title, body) = {
  block(
    stroke: (left: 2pt + primary_color),
    radius: 3pt,
    inset: 10pt,
    width: 100%,
    breakable: true,
  )[
    #text(weight: "bold")[å®šä¹‰ï¼š#title]
    \
    #body
  ]
}

// å®šç†æ¨¡å— (è‡ªåŠ¨ç¼–å·)
#let theorem_counter = counter("theorem")
#let theorem(title, body) = {
  theorem_counter.step()
  block(
    fill: bg_color,
    radius: 3pt,
    inset: 10pt,
    width: 100%,
    breakable: true,
  )[
    #text(weight: "bold")[å®šç† #theorem_counter.display("1")ï¼š#title]
    \
    #body
  ]
}

// ç¤ºä¾‹æ¨¡å—
#let example(title, body) = {
  v(0.5em)
  block(
    stroke: (top: 1pt + accent_color.lighten(20%)),
    inset: (top: 10pt, bottom: 10pt, x: 8pt),
    width: 100%,
    breakable: true,
  )[
    #text(weight: "bold", style: "italic", accent_color)[ç¤ºä¾‹ï¼š#title]
    \
    #body
  ]
  v(0.5em)
}

// å…³é”®ç‚¹æ¨¡å—
#let keypoint(body) = {
  block(
    fill: accent_color.lighten(80%),
    radius: 4pt,
    inset: 10pt,
    width: 100%,
    breakable: true,
  )[
    *ğŸ’¡ å…³é”®ç‚¹* \
    #body
  ]
}

// é‡è¦å…¬å¼æ¨¡å— (è‡ªåŠ¨ç¼–å·)
#let formula_counter = counter("formula")
#let formula(eq) = {
  formula_counter.step()
  align(center, $ #eq $)
  align(right, text(9pt, fill: gray)[(#formula_counter.display())])
  v(0.5em)
}

// --- æ ‡é¢˜é¡µå‡½æ•° ---
#let title_page() = {
  // ç¦ç”¨å½“å‰é¡µçš„é¡µçœ‰é¡µè„š
  set page(header: none, footer: none)
  align(center + horizon)[
    #v(3cm)
    #text(28pt, weight: "bold")[æ•°æ®è¦ç´ äº¤æ˜“åŸºç¡€]
    #v(1cm)
    #text(16pt)[Course Notes]
    #v(2cm)
    #line(length: 30%, stroke: 0.5pt)
    #v(2cm)
    #grid(
      columns: (1fr, 2fr),
      gutter: 1em,
      [è®²å¸ˆï¼š], [åˆ˜é‡‘é£],
      [å­¦æœŸï¼š], [2025 å¹´æš‘],
      [å­¦ç”Ÿï¼š], [forliage],
    )
    #v(6cm)
  ]
  // æ¢å¤é¡µçœ‰é¡µè„š
  pagebreak()
  set page(
    header: align(center)[#text(10pt, fill: gray)[æ•°æ®è¦ç´ äº¤æ˜“åŸºç¡€]#line(length: 100%, stroke: 0.5pt + gray)],
    footer: align(right)[#counter(page).display("1 / 1")]
  )
  counter(page).update(1) // é‡ç½®é¡µç ä¸º1
}

= Lecture 6: å¤šè‡‚è€è™æœºç®—æ³•åŸºç¡€ä¸åº”ç”¨

== ä¸€ã€éšæœºå¤šè‡‚è€è™æœº

=== 1.ä¸€èˆ¬çš„æœºå™¨å­¦ä¹ ä»»åŠ¡

å¸¸è§ï¼šImage recognition, Preference learning for recommendations, Speech recognition, Next token/word prediction(for language models)

ä»¥ä¸Šéƒ½æ˜¯åŸºäºæ¨¡å¼è¯†åˆ«çš„å­¦ä¹ é—®é¢˜(recognition-based learning problems);
- å­¦ä¹ ç¯å¢ƒé€šå¸¸æ˜¯ç»™å®šçš„ï¼šè¾“å…¥å›¾ç‰‡/è¯­è¨€...è¾“å‡ºæ ‡ç­¾ï¼›
- é€šå¸¸ä½¿ç”¨ç›‘ç£å­¦ä¹ ï¼šå­¦ä¹ ç‰¹å¾åˆ°æ ‡ç­¾çš„æ˜ å°„ã€‚
æœ¬è®²ä»‹ç»çš„æ˜¯åŸºäºå†³ç­–çš„å­¦ä¹ é—®é¢˜(decision-based learning problems);
- å­¦ä¹ ç¯å¢ƒé€šå¸¸æ˜¯åŠ¨æ€çš„ï¼›
- é€šè¿‡å†³ç­–è¿‡ç¨‹ä¸­è·å¾—çš„å¥–åŠ±/ä»£ä»·å­¦ä¹ åˆ°æœ€ä¼˜ç­–ç•¥(AlphaGo)ï¼›
- å¼ºåŒ–å­¦ä¹ (reinforcement learning)ï¼›
- å¤šè‡‚è€è™æœºï¼šæ— çŠ¶æ€è½¬ç§»çš„å¼ºåŒ–å­¦ä¹ ã€‚

=== 2.å¤šè‡‚è€è™æœºé—®é¢˜ï¼šå¼•å…¥
ä¸€ä¸ªèµŒé¬¼è¦ç©å¤šè‡‚è€è™æœºï¼Œæ‘†åœ¨ä»–é¢å‰æœ‰$K$ä¸ªè‡‚(Arms)æˆ–åŠ¨ä½œé€‰æ‹©(Actions)ï¼Œæ¯ä¸€è½®æ¸¸æˆä¸­ï¼Œä»–è¦é€‰æ‹©æ‹‰åŠ¨ä¸€ä¸ªè‡‚å¹¶ä¼šè·å¾—ä¸€ä¸ªéšæœºå¥–åŠ±(reward)(è¿™ä¸€éšæœºå¥–åŠ±æ¥æºäºä¸€ä¸ªèµŒåœºè®¾å®šå¥½çš„åˆ†å¸ƒï¼Œä½†èµŒé¬¼ä¸€å¼€å§‹ä¸çŸ¥é“è¿™ä¸€åˆ†å¸ƒ)ã€‚å¦‚æœæ€»å…±ç©$T$è½®ï¼Œä»–è¯¥å¦‚ä½•æœ€å¤§åŒ–å¥–åŠ±ï¼Ÿ
$ r_i ~ D_i ("for " i = 1,..,k) $
å…¶å®ƒåœºæ™¯ï¼šæ–°é—»ç½‘ç«™(æ¨èç³»ç»Ÿ)ã€åŠ¨æ€å®šä»·ã€æŠ•èµ„ç»„åˆ///

é—®é¢˜æœ¬è´¨ï¼šexplore and exploitã€‚ä¾‹å¦‚æ–°é—»ç½‘ç«™çš„æ¨èï¼Œå¯ä»¥å…ˆå°è¯•å‡ æ¬¡éšæœºæ¨èæ¢ç´¢ç”¨æˆ·çš„å–œå¥½ï¼Œ
ç„¶ååˆ©ç”¨è¿™å‡ æ¬¡å°è¯•å­¦ä¹ åˆ°çš„ç»“æœåšå‡ºæ¯”è¾ƒå‡†ç¡®çš„æ¨èã€‚

=== 3.åŸºæœ¬æ¦‚å¿µ
æ ¹æ®åé¦ˆç±»å‹åˆ†ç±»ï¼š
- å®Œå…¨åé¦ˆ(full feedback)ï¼šèƒ½çœ‹è§æ‰€æœ‰è‡‚çš„å¥–åŠ±ï¼Œä¾‹å¦‚æŠ•èµ„ç»„åˆè‚¡ç¥¨çš„æ¶¨è·Œï¼›
- éƒ¨åˆ†åé¦ˆ(partial feedback)ï¼šèƒ½çœ‹è§éƒ¨åˆ†è‡‚çš„å¥–åŠ±ï¼Œä¾‹å¦‚åŠ¨æ€å®šä»·ä¸­ä»»ä½•æ›´ä½(é«˜)ä»·æ ¼éƒ½è¢«æ¥å—(æ‹’ç»)ï¼›
- è€è™æœºåé¦ˆ(bandit feedback)ï¼šåªèƒ½çœ‹è§é€‰æ‹©çš„è‡‚çš„å¥–åŠ±ï¼Œä¾‹å¦‚æ–°é—»ç½‘ç«™ä¸Šè¯¥æ–°é—»æ˜¯å¦è¢«ç”¨æˆ·ç‚¹å‡»ã€‚

æ ¹æ®å¥–åŠ±ç±»å‹åˆ†ç±»ï¼š
- éšæœºå¥–åŠ±/IIDå¥–åŠ±ï¼šç©å®¶æˆ–è€…çš„å¥–åŠ±éšæœºæ›²å­ä¸€ä¸ªæœªçŸ¥æ¦‚ç‡åˆ†å¸ƒ
- å¯¹æŠ—æ€§å¥–åŠ±ï¼šå¥–åŠ±å¯ä»¥ä»»æ„ï¼Œèƒ½ç”±ä¸€ä¸ª"å¯¹æ‰‹"æœ‰é’ˆå¯¹æ€§çš„é€‰æ‹©

=== 4.éšæœºå¤šè‡‚è€è™æœºé—®é¢˜æ¨¡å‹

åœ¨æ¯ä¸€æ­¥$t=1,2,...,T$ä¸­ï¼š
+ ç©å®¶é€‰æ‹©ä¸€ä¸ªè‡‚$a_t in A = {a_1,...,a_K}$;
+ ç©å®¶è·å¾—è¯¥è‡‚å¯¹åº”çš„éšæœºå¥–åŠ±$r_t ~ R(a_t) (r_t in [0,1])$ï¼›
+ ç©å®¶ä¾æ®è¿‡å¾€è½®æ¬¡çš„å¥–åŠ±æƒ…å†µè°ƒæ•´é€‰æ‹©ç­–ç•¥ï¼Œå®ç°å¥–åŠ±æœ€å¤§ã€‚

è¯´æ˜ï¼š
- å¥–åŠ±åˆ†å¸ƒçš„å‡å€¼è®°ä¸º$mu(a_k)= bb(E)[R(a_k)], k in [K]$ï¼›
- æœ€ä¼˜è‡‚$a^ast$çš„å¥–åŠ±å‡å€¼$mu^ast = max_(a in A) mu(a)$ï¼›
- å¥–åŠ±å‡å€¼å·®å¼‚$Delta (a) = mu^ast - mu(a)$ã€‚ 

=== 5.é—æ†¾åˆ†æ
æˆ‘ä»¬éœ€è¦è®¾è®¡MABç®—æ³•å®ç°æœ€å¤§åŒ–å¥–åŠ±ï¼Œå®é™…ä¸Šå°±æ˜¯æ‰¾æœ€ä¼˜è‡‚ã€‚é‚£ä¹ˆï¼Œåˆ†æMABç®—æ³•çš„æ€§èƒ½å°±æ˜¯åœ¨åˆ†æç®—æ³•èƒ½å¦æ‰¾åˆ°æœ€ä¼˜è‡‚ã€‚æˆ‘ä»¬ç”¨é—æ†¾(regret)æ¥åº¦é‡å®é™…é€‰æ‹©å’Œæœ€ä¼˜é€‰æ‹©çš„å·®å¼‚ã€‚

å®šä¹‰ï¼š
+ ä¼ªé—æ†¾(pseudo-regret)ï¼š$ R(T)= sum_(t=1)^T (mu^ast - mu(a_t)) = mu^ast dot T - sum_(t=1)^T mu(a_t) $
+ æœŸæœ›é—æ†¾(expected regret):$bb(E)[R(T)]$ã€‚

å³ä¼ªé—æ†¾å°±æ˜¯é€‰æ‹©æœ€ä¼˜è‡‚çš„æœŸæœ›æ”¶ç›Šå‡å»å®é™…æ”¶ç›Šï¼ŒæœŸæœ›é—æ†¾æ˜¯ä¼ªé—æ†¾çš„æœŸæœ›(ç©å®¶ç­–ç•¥å¯èƒ½å­˜åœ¨éšæœºæ€§ï¼Œå› æ­¤$mu(a_t)$å¯èƒ½æ˜¯éšæœºå˜é‡)ã€‚æ˜¾ç„¶ï¼Œæœ€å¤§åŒ–å¥–åŠ±çš„ç›®æ ‡å¯ä»¥ç­‰ä»·ä¸ºæœ€å°åŒ–é—æ†¾çš„ç›®æ ‡ã€‚

åœ¨MABé—®é¢˜ä¸­ï¼Œwineå§å¸¸å¸¸å…³æ³¨ç®—æ³•é—æ†¾ç•Œ(regret bound)ã€‚ä¸€ä¸ªå¥½çš„é—æ†¾ç•Œæ˜¯æ¬¡çº¿æ€§çš„(sub-linear)ï¼Œè¿™æ„å‘³ç€ç®—æ³•èƒ½é€æ¸å­¦åˆ°æœ€ä¼˜è‡‚ï¼Œå³$ ("regret bound")/T -> 0, T->infinity $

=== 6.Hoeffdingä¸ç­‰å¼

å‡è®¾$X_1,X_2,...,X_n$æ˜¯$[0,1]$ä¸Šçš„ç‹¬ç«‹éšæœºå˜é‡ï¼Œæ ·æœ¬å‡å€¼ä¸º$overline(X_n)= 1/n sum_(i=1)^n X_i, mu = bb(E)[overline(X_n)]$ã€‚å¯¹äºä»»æ„$epsilon >0$æœ‰ï¼š
$ bb(P)( |mu - overline(X_n)| >= epsilon)<= 2 exp(-2 n epsilon^2) $

è¯¥ä¸ç­‰å¼å±äºé›†ä¸­ä¸ç­‰å¼(concentration inequalities)ï¼Œç›´è§‚ä¸Šæ¥è¯´$bb(P)(|mu - overline(X_n)|<= "small") >= 1 - "small"$ï¼Œå³æ ·æœ¬å‡å€¼ä¸å®é™…å‡å€¼çš„å·®è·å¾ˆå°çš„æ¦‚ç‡æ˜¯å¾ˆå¤§çš„ï¼Œå¹¶ä¸”éšæœºå˜é‡ä¸ªæ•°è¶Šå¤š($N$è¶Šå¤§)å·®è·å¤§çš„æ¦‚ç‡è¶Šå°ã€‚

ä¸å¤šè‡‚è€è™æœºé—®é¢˜çš„å…³è”ï¼šå°†$X_1,...,X_n$è§†ä¸ºé€‰æ‹©ä¸€ä¸ªè‡‚$n$æ¬¡å¾—åˆ°çš„$n$ä¸ªå¥–åŠ±ï¼Œè¿™ä¸€ä¸ç­‰å¼è¡¨æ˜ï¼Œå½“$n$å¾ˆå¤§æ—¶ï¼Œé‡‡æ ·å‡ºçš„å¥–åŠ±å‡å€¼å’Œè‡‚çš„çœŸå®å‡å€¼éå¸¸æ¥è¿‘çš„ã€‚

ç§°$[mu-epsilon,mu+epsilon]$æ˜¯ç½®ä¿¡åŒºé—´(confidence interval)ï¼Œ$epsilon$æ˜¯ç½®ä¿¡åŠå¾„(confidence radius)ã€‚è‹¥ä»¤$epsilon=sqrt((alpha log T)/n)$ï¼Œåˆ™æœ‰
$ bb(P)(|mu-overline(X_n)|>=epsilon)=bb(P)(|mu-overline(X_n)|>= sqrt((alpha log T)/n))<=2 T^(-2 alpha), forall alpha > 0 $
åœ¨æ¥ä¸‹æ¥çš„è®¨è®ºä¸­ä¸€èˆ¬å–$alpha=2$

=== 7.è´ªå¿ƒç®—æ³•
ä¸ºäº†æ‰¾åˆ°é‚£ä¸ªæœ€å¥½çš„è‡‚ï¼Œä¸€ä¸ªæœ´ç´ çš„è§£å†³æ€è·¯æ˜¯ï¼Œå°†æ‰€æœ‰è‡‚éƒ½å°è¯•ä¸€éï¼Œç„¶åé€‰æ‹©è¡¨ç°æœ€å¥½çš„è‡‚ï¼Œå¹¶åœ¨åç»­çš„æ—¶é—´æ­¥ä¸­ä¿æŒè¿™ç§é€‰æ‹©ã€‚è´ªå¿ƒç®—æ³•å°±æ˜¯è¿™ä¹ˆä¸€ç§ç®—æ³•ï¼Œå®ƒé‡‡ç”¨"å®Œå…¨åå‘åˆ©ç”¨"çš„ç­–ç•¥ï¼Œå…¶åŸºæœ¬ç­–ç•¥æ˜¯â€œå§‹ç»ˆé€‰æ‹©å½“å‰ä¼°è®¡å¥–åŠ±æœ€é«˜çš„è‡‚ï¼Œå¹¶åˆ©ç”¨å†å²ç»éªŒæ›´æ–°å¯¹æ¯ä¸ªè‡‚çš„å¥–åŠ±ä¼°è®¡å€¼ã€‚

#block(
  stroke: (top: 1pt, bottom: 1pt), // è®¾ç½®ä¸Šä¸‹è¾¹æ¡†çº¿
  inset: 8pt, // è®¾ç½®å†…éƒ¨ç•™ç™½
  width: 100% // å®½åº¦å æ»¡
)[
  #grid(
    columns: (auto, 1fr), // ç¬¬ä¸€åˆ—ï¼ˆè¡Œå·ï¼‰å®½åº¦è‡ªé€‚åº”ï¼Œç¬¬äºŒåˆ—ï¼ˆå†…å®¹ï¼‰å æ»¡
    column-gutter: 1em,   // åˆ—é—´è·
    row-gutter: 0.65em,   // è¡Œé—´è·

    // ç¬¬ 1 è¡Œ
    "1:", [æ¢ç´¢é˜¶æ®µï¼šå°†æ¯ä¸ªè‡‚å„å°è¯• $N$ æ¬¡],

    // ç¬¬ 2 è¡Œ
    "2:", [åˆ©ç”¨é˜¶æ®µï¼š],

    // ç¬¬ 3 è¡Œ (ä¸€çº§ç¼©è¿›)
    "3:", [#h(2em) *for* $t > K N$ *do*],

    // ç¬¬ 4 è¡Œ (äºŒçº§ç¼©è¿›)
    "4:", [#h(4em) é€‰æ‹©å¹³å‡å¥–åŠ±æœ€é«˜çš„è‡‚ $hat(a) = arg max_a Q_t(a)$],

    // ç¬¬ 5 è¡Œ (äºŒçº§ç¼©è¿›)
    "5:", [
      #h(4em) è§‚å¯Ÿå¥–åŠ± $r_t$, $N_(t+1)(hat(a)) = N_t(hat(a)) + 1$,
      $Q_(t+1)(hat(a)) = Q_t(hat(a)) + (r_t - Q_t(hat(a))) / (N_(t+1)(hat(a)))$
    ],
    
    // ç¬¬ 6 è¡Œ (ä¸€çº§ç¼©è¿›)
    "6:", [#h(2em) *end for*],
  )
]

æ³¨æ„$N_t (hat(a))$çš„å«ä¹‰æ˜¯ç¬¬$t$è½®å‰$hat(a)$è¢«é€‰è¿‡çš„æ¬¡æ•°ï¼Œ
$ Q_(t+1) (hat(a)) = Q_t (hat(a)) + (r_t - Q_t (hat(a)))/(N_(t+1) (hat(a))) $
åˆ™æ˜¯åœ¨æ›´æ–°$hat(a)$çš„å¹³å‡å¥–åŠ±ã€‚ç¬¬$t$è½®æœªè¢«é€‰ä¸­çš„è‡‚å¯¹åº”çš„$N$å’Œ$Q$å€¼ä¸å˜ã€‚

=== 8.è´ªå¿ƒç®—æ³•çš„é—æ†¾åˆ†æ

å®šç†ï¼šè´ªå¿ƒç®—æ³•çš„é—æ†¾ç•Œä¸º$O(T^(2/3) (K log T)^(1/3))$ã€‚ 

é¦–å…ˆè€ƒè™‘$K=2$çš„æƒ…å†µï¼Œå³åªæœ‰ä¸¤ä¸ªè‡‚ã€‚é—æ†¾äº§ç”Ÿå½“ä¸”ä»…å½“é€‰æ‹©äº†æ¬¡ä¼˜è‡‚$a != a^ast$ã€‚æ˜¾ç„¶ï¼Œæ¢ç´¢é˜¶æ®µçš„é—æ†¾ä¸º
$ R("exploration") <= N $
å¯¹äºåˆ©ç”¨é˜¶æ®µï¼Œåˆ†ä¸ºä¸¤ç§æƒ…å†µè€ƒè™‘(é€šå¸¸çš„åˆ†æå¥—è·¯)ï¼š 
+ äº‹ä»¶$E$ï¼šæ‰€æœ‰è‡‚$a$å‡æ»¡è¶³$|mu(a) - Q(a)|<= sqrt((2 log T)/T)$ï¼Œå³ä¸¤ä¸ªè‡‚çš„é‡‡æ ·æœŸæœ›å¥–åŠ±$Q(a)$ä¸çœŸå®æœŸæœ›$mu(a)$é—´å·®è·éƒ½ä¸å¤§çš„æƒ…å†µï¼›
+ äº‹ä»¶$overline(E)$ï¼šäº‹ä»¶$E$çš„è¡¥é›†ã€‚

åˆ™æœ‰ï¼š
$
& bb(E)[R("exploitation")] \
& <= bb(E)[R("exploitation") | E] times bb(P)(E) + bb(E)[R("exploitation") | overline(E)] times bb(P)(overline(E)) \
& <= bb(E)[R("exploitation") | E] + T times O(1/T^4)
$

å…¶ä¸­$O(1/(T^4))$æ¥æºäº
$ bb(P)(|mu(a) - Q(a)|<= sqrt((2 log T)/N))>= 1 - 2 T^(-4) $
ç”±æ­¤å¯ä»¥çœ‹å‡ºï¼Œå¦‚ä¸Šæ‹†åˆ†æˆä¸¤ä¸ªäº‹ä»¶çš„ç›®æ ‡æ˜¯è¯´æ˜å¤§æ¦‚ç‡å‘ç”Ÿçš„äº‹ä»¶é—æ†¾
å°ï¼Œé—æ†¾å¤§çš„äº‹ä»¶å‘ç”Ÿæ¦‚ç‡å°ï¼Œç»¼åˆäºŒè€…å¯ä»¥è¯æ˜é—æ†¾æ˜¯æ¯”è¾ƒå°çš„ã€‚

è®°$"rad"=sqrt((2 log T)/N)$ï¼Œåœ¨äº‹ä»¶$E$ä¸‹äº§ç”Ÿé—æ†¾æ—¶ï¼Œæœ‰
$ mu(a) + "rad" >= Q(a)>Q(a^ast) >= mu(a^ast) - "rad" $
å…¶ä¸­é¦–å°¾ä¸¤ä¸ª$>=$æ¥æºäº$E$çš„å®šä¹‰ï¼Œä¸­é—´çš„$>$æ¥æºäºæ­¤æ—¶äº§ç”Ÿäº†é—æ†¾ï¼Œå³æœ€å¥½çš„è‡‚çš„é‡‡æ ·æœŸæœ›æ¯”æ¬¡ä¼˜çš„è‡‚å°ã€‚æ•´ç†å¾—$mu(a^ast) - mu(a) <= 2 "rad"$ã€‚é‚£ä¹ˆ
$
& bb(E)[R("exploitation")] \
& <= bb(E)[R("exploitation") | E] + T times O(1/(T^4)) \
& <= (T - 2 N) dot 2 "rad" + O(1/(T^3))
$

ç»¼åˆæ¢ç´¢å’Œåˆ©ç”¨çš„é—æ†¾å¯å¾—$bb(E)[R(T)] <= N + 2 "rad" T + O(1/(T^3))$ã€‚è‹¥ä»¤$N=T^(2/3) (log T)^(1/3)$ï¼Œåˆ™æœ‰$bb(E)[R(T)]<= O(T^(2/3) (log T)^(1/3))$ã€‚ 

ä¸‹é¢è€ƒè™‘$K>2$çš„æƒ…å†µï¼Œæ¢ç´¢é˜¶æ®µçš„é—æ†¾ä¸º
$ R("exploitation")<= N(K-1) $
åˆ©ç”¨é˜¶æ®µçš„é—æ†¾ä¸º
$
& bb(E)[R("exploitation")] \
& <= bb(E)[R("exploitation") | E] times bb(P)(E) + bb(E)[R("exploitation") | overline(E)] times bb(P)(overline(E)) \ 
& <= (T - N K) dot 2 "rad" + O(1/(T^3)) 
$

ç»¼åˆæ¢ç´¢å’Œåˆ©ç”¨çš„é—æ†¾å¯å¾—$bb(E)[R(T)]<= N K + 2 "rad" T+ O(1/(T^3))$ã€‚è‹¥ä»¤ 
$N = (T/K)^(2/3) dot O(log T)^(1/3)$ï¼Œåˆ™æœ‰$bb(E)[R(T)]<= O(T^(2/3) (K log T)^(1/3))$ 

=== 8.$epsilon$-è´ªå¿ƒç®—æ³• 

å›æƒ³ä¸Šé¢çš„è´ªå¿ƒç®—æ³•å­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼š
- â€œæ¢ç´¢â€é˜¶æ®µçš„å°è¯•å¸¦æ¥é—æ†¾ï¼›
- â€œåˆ©ç”¨â€é˜¶æ®µé™·äºå±€éƒ¨æœ€ä¼˜å¸¦æ¥é—æ†¾ã€‚

ä¸ºäº†è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜ï¼Œ$epsilon$-è´ªå¿ƒç®—æ³•å¼•å…¥äº†éšæœºæ€§ï¼Œåœ¨â€œæ¢ç´¢â€ä¸â€œåˆ©ç”¨â€ä¹‹é—´å®ç°äº†è¾ƒå¥½çš„æƒè¡¡ï¼›
- å…¶æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šä»¥$1- epsilon$çš„æ¦‚ç‡é€‰æ‹©å½“å‰å·²åœ¨æœ€ä¼˜çš„è‡‚$a^prime = arg max_(a) Q_t (a)$ï¼Œä»¥$epsilon$çš„æ¦‚ç‡éšæœºé€‰æ‹©ä¸€ä¸ªè‡‚ï¼›
- å‰ä¸€æ­¥ä»£è¡¨å¯¹å½“å‰çŸ¥è¯†çš„â€œåˆ©ç”¨â€ï¼Œåä¸€æ­¥ä»£è¡¨å¯¹å¯èƒ½æœ€ä¼˜çš„â€œæ¢ç´¢â€ï¼Œä»è€Œé¿å…é™·å…¥å±€éƒ¨æœ€ä¼˜ï¼›
- é€šè¿‡è°ƒæ•´$epsilon (0<= epsilon <= 1)$çš„å€¼ï¼Œå¯ä»¥æ§åˆ¶æ¢ç´¢å’Œåˆ©ç”¨ä¹‹é—´çš„å¹³è¡¡ï¼›è¾ƒå°çš„$epsilon$å€¼å€¾å‘äºæ›´å¤šçš„åˆ©ç”¨ï¼Œè€Œè¾ƒå¤§çš„$epsilon$å€¼å€¾å‘äºæ›´å¤šçš„æ¢ç´¢ï¼›é€šå¸¸è€Œè¨€ä¼šå°†$epsilon$è®¾ç½®æˆä¸€ä¸ªè¾ƒå°çš„å€¼ã€‚

#block(
  stroke: (top: 1pt, bottom: 1pt), // è®¾ç½®ä¸Šä¸‹è¾¹æ¡†çº¿
  inset: 8pt, // è®¾ç½®å†…éƒ¨ç•™ç™½
  width: 100% // å®½åº¦å æ»¡
)[
  #grid(
    columns: (auto, 1fr), // ç¬¬ä¸€åˆ—å®½åº¦è‡ªé€‚åº”ï¼Œç¬¬äºŒåˆ—å æ»¡å‰©ä½™ç©ºé—´
    column-gutter: 1em,   // ä¸¤åˆ—ä¹‹é—´çš„é—´è·
    row-gutter: 0.65em,   // è¡Œé—´è·

    // ç¬¬ 1 è¡Œ
    "1:", [*for* $t = 1, 2, ..., T$ *do*],
    
    // ç¬¬ 2 è¡Œ (ç¼©è¿›)
    "2:", [#h(2em) ä»¥ $epsilon_t$ çš„æ¦‚ç‡æ¢ç´¢ï¼šéšæœºé€‰æ‹©ä¸€ä¸ªè‡‚],
    
    // ç¬¬ 3 è¡Œ (ç¼©è¿›)
    "3:", [#h(2em) ä»¥ $(1 - epsilon_t)$ çš„æ¦‚ç‡åˆ©ç”¨ï¼šé€‰æ‹© $a_t = arg max_a Q_t(a)$],
    
    // ç¬¬ 4 è¡Œ (ç¼©è¿›)
    "4:", [
      #h(2em) è§‚å¯Ÿå¥–åŠ± $r_t$, $N_(t+1)(hat(a)) = N_t(hat(a)) + 1$,
      $Q_(t+1)(hat(a)) = Q_t(hat(a)) + (r_t - Q_t(hat(a))) / (N_(t+1)(hat(a)))$
    ],

    // ç¬¬ 5 è¡Œ
    "5:", [*end for*],
  )
]

é€šè¿‡é€‰æ‹©åˆé€‚çš„$epsilon$å€¼ï¼Œå¯ä»¥è¯æ˜$epsilon$-è´ªå¿ƒç®—æ³•çš„é—æ†¾ä¸Šç•Œï¼š

å®šç†ï¼šä»¤$epsilon_t = t^(- 1/3) (K log t)^(1/3)$ï¼Œ$epsilon$-è´ªå¿ƒç®—æ³•çš„é—æ†¾ç•Œä¸º$O(T^(2/3) (K log T)^(1/3))$ã€‚ ï¼ˆå®šç†çš„è¯æ˜åœ¨hw1.typä¸­ï¼‰

è¯¥ç®—æ³•çš„ä¼˜åŠ¿æ˜¯ç®€å•æ˜“å®ç°ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡è°ƒæ•´$epsilon$çµæ´»æ§åˆ¶æ¢ç´¢ä¸åˆ©ç”¨ã€‚

=== 9.ä¸Šç½®ä¿¡ç•Œç®—æ³•

$epsilon$-è´ªå¿ƒç­–ç•¥å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼šè™½ç„¶æ¯ä¸ªåŠ¨ä½œéƒ½æœ‰è¢«é€‰æ‹©çš„æ¦‚ç‡ï¼Œä½†æ˜¯è¿™ç§é€‰æ‹©å¤ªè¿‡äºéšæœºï¼Œå¯¼è‡´æœ€ä¼˜è‡‚è¢«è®¿é—®çš„æ¦‚ç‡è¾ƒä½ï¼Œè¿™å¹¶ä¸èƒ½æœ‰åŠ©äºæ™ºèƒ½ä½“å¾ˆå¤§æ¦‚ç‡çš„å‘ç°æœ€ä¼˜é€‰æ‹©ï¼Œä¸Šç½®ä¿¡ç•Œç®—æ³•ï¼ˆupper confidence boundï¼ŒUCBï¼‰å¾ˆå¥½åœ°æ”¹è¿›äº†è¿™ä¸€ç‚¹ã€‚

UCB ç®—æ³•æ˜¯å¤šè‡‚èµŒåšæœºé—®é¢˜ä¸­ä¸€ç§ç»å…¸çš„åŸºäºç½®ä¿¡åŒºé—´çš„æ¢ç´¢-åˆ©ç”¨ç­–ç•¥ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯ä¸ºæ¯ä¸ªè‡‚çš„å¥–åŠ±ä¼°è®¡æ„å»ºä¸€ä¸ªç½®ä¿¡åŒºé—´ä¸Šç•Œï¼Œé€‰æ‹©ä¸Šç•Œæœ€å¤§çš„è‡‚ï¼Œä»è€Œåœ¨æ¢ç´¢å’Œåˆ©ç”¨ä¹‹é—´è‡ªåŠ¨å¹³è¡¡ã€‚

#block(
  stroke: (top: 1pt, bottom: 1pt), // è®¾ç½®ä¸Šä¸‹è¾¹æ¡†çº¿
  inset: 8pt, // è®¾ç½®å†…éƒ¨ç•™ç™½
  width: 100% // å®½åº¦å æ»¡
)[
  #grid(
    columns: (auto, 1fr), // åˆ—å®šä¹‰ï¼šç¬¬ä¸€åˆ—å®½åº¦è‡ªé€‚åº”ï¼Œç¬¬äºŒåˆ—å æ»¡
    column-gutter: 1em,   // åˆ—é—´è·
    row-gutter: 0.65em,   // è¡Œé—´è·

    // ç¬¬ 1 è¡Œ (é¡¶å±‚)
    "1:", [å¯¹äºæ¯ä¸ªå€™é€‰é¡¹ $k=1, ..., K$, ä»¤ $Q_1(a_k) = 0, N_1(a_k) = 0$],

    // ç¬¬ 2 è¡Œ (é¡¶å±‚)
    "2:", [*for* $t = 1, ..., T$ *do*],

    // ç¬¬ 3 è¡Œ (ä¸€çº§ç¼©è¿›)
    "3:", [#h(2em) *if* $t <= K$ *then*],

    // ç¬¬ 4 è¡Œ (äºŒçº§ç¼©è¿›)
    "4:", [#h(4em) åˆå§‹åŒ–é¡ºåºé€‰æ‹©æ¯ä¸ªè‡‚],

    // ç¬¬ 5 è¡Œ (ä¸€çº§ç¼©è¿›)
    "5:", [#h(2em) *else*],

    // ç¬¬ 6 è¡Œ (äºŒçº§ç¼©è¿›)
    "6:", [#h(4em) é€‰æ‹© $a_t = arg max_a (Q_t(a) + sqrt((2 ln t)/N_t(a)))$],

    // ç¬¬ 7 è¡Œ (ä¸€çº§ç¼©è¿›)
    "7:", [#h(2em) *end if*],
    
    // ç¬¬ 8 è¡Œ (ä¸€çº§ç¼©è¿›)
    "8:", [
      #h(2em) è§‚å¯Ÿå¥–åŠ± $r_t$, $N_(t+1)(a_t) = N_t(a_t) + 1$,
      $Q_(t+1)(a_t) = Q_t(a_t) + (r_t - Q_t(a_t))/(N_(t+1)(a_t))$
    ],

    // ç¬¬ 9 è¡Œ (é¡¶å±‚)
    "9:", [*end for*],
  )
]

ç®€è€Œè¨€ä¹‹ï¼ŒUCB çš„ç®—æ³•æµç¨‹æ˜¯ï¼šé¦–å…ˆå°†æ¯ä¸€ä¸ªå€™é€‰è‡‚éƒ½é€‰æ‹©ä¸€éï¼Œä½œä¸ºåˆå§‹åŒ–ï¼›ç„¶ååœ¨åç»­çš„æ—¶é—´æ­¥ä¸­ï¼Œé€‰æ‹©å¥–åŠ±å‡å€¼ä¼°è®¡é‡çš„ä¸Šç½®ä¿¡ç•Œæœ€å¤§çš„è‡‚ï¼Œå…¶ä¸­å‡å€¼ä¼°è®¡é‡çš„ä¸Šç½®ä¿¡ç•Œå®šä¹‰ä¸º
$ Q_t (a) + sqrt((2 ln t)/(N_t (a))) $
æœ€åæ›´æ–°è¢«é€‰ä¸­çš„è‡‚çš„ç›¸å…³å‚æ•°ã€‚å…¶ä¸­ä¸Šç½®ä¿¡ç•Œçš„ç›´è§‚ç†è§£æ˜¯ï¼š
- ä¸Šç½®ä¿¡ç•Œçš„å‰ä¸€é¡¹$Q_t (a)$ä»£è¡¨è‡‚çš„ä¼°è®¡å¥–åŠ±ï¼Œè¿™ä¸ªå€¼è¶Šå¤§è¯´æ˜å¯¹åº”è‡‚çš„å†å²è¡¨ç°è¶Šå¥½ï¼›
- åä¸€é¡¹$sqrt((2 ln t)/(N_t (a)))$æ˜¯ç½®ä¿¡åŒºé—´çš„åŠå¾„ï¼Œå…¶ä¼šéšç€é€‰æ‹©æ¬¡æ•°çš„å¢åŠ è€Œå˜å°ï¼Œå¹¶ä¸”è¯¥å€¼è¶Šå¤§åˆ™è¯´æ˜ä¼°è®¡çš„ä¸ç¡®å®šæ€§è¶Šå¤§ï¼Œå› æ­¤èƒ½è¿‡é¼“åŠ±ç©å®¶å°è¯•è¾ƒå°‘è¢«é€‰æ‹©çš„è‡‚ï¼Œé¿å…é™·å…¥æ¬¡ä¼˜ï¼›
- å› æ­¤ï¼Œé€‰æ‹©ä¸Šç½®ä¿¡ç•Œæœ€å¤§çš„è‡‚æœ‰åˆ©äºåå‘äºé€‰æ‹©è¡¨ç°è¾ƒå¥½æˆ–æ˜¯è¾ƒå°‘é€‰æ‹©çš„è‡‚ï¼Œä»è€Œç®—æ³•èƒ½å¤Ÿé€æ¸æ”¶æ•›åˆ°æœ€ä¼˜è‡‚ã€‚

æ€»è€Œè¨€ä¹‹ã€‚UCB ç®—æ³•åŒæ—¶è€ƒè™‘äº†ä¼°è®¡å¥–åŠ±ä¸ä¸ç¡®å®šæ€§ï¼Œè¾ƒå¥½çš„å¹³è¡¡äº†æ¢ç´¢ä¸åˆ©ç”¨ï¼Œä¹Ÿå¯ä»¥å¾—åˆ°æ›´å¥½çš„é—æ†¾ç•Œï¼š

å®šç†ï¼šUCBç®—æ³•çš„é—æ†¾ç•Œä¸º$O(sqrt(K T log T))$ã€‚ 

æˆ‘ä»¬æ¥è¡¥å……æ­¤å®šç†çš„è¯æ˜ï¼šæˆ‘ä»¬å…ˆæ¥åˆ†æåœ¨ä»€ä¹ˆæƒ…å†µä¸‹ä¸€ä¸ªæ¬¡ä¼˜è‡‚$i$(å³$Delta_i > 0$)ä¼šåœ¨ç¬¬$t$è½®è¢«é€‰æ‹©ã€‚æ ¹æ®UCBçš„è§„åˆ™ï¼Œå¦‚æœè‡‚$i$è¢«é€‰ä¸­ï¼Œé‚£ä¹ˆå®ƒçš„UCBå€¼å¿…é¡»å¤§äºç­‰äºæœ€ä¼˜è‡‚$a^ast$çš„UCBå€¼ï¼š
$ hat(mu)_(i,N_i (t-1)) + sqrt((2 log t)/(N_i (t-1))) >= hat(mu)_(a^ast, N_(a^ast) (t-1)) + sqrt((2 log t) / (N_(a^ast) (t-1))) $
ä¸ºäº†ä½¿è¿™ä¸ªä¸ç­‰å¼æˆç«‹ï¼Œä»¥ä¸‹ä¸‰ç§æƒ…å†µä¸­è‡³å°‘æœ‰ä¸€ç§å¿…é¡»å‘ç”Ÿï¼š
+ æœ€ä¼˜è‡‚è¢«ä½ä¼° (Pessimistic estimate for optimal arm): æœ€ä¼˜è‡‚çš„ç»éªŒå¹³å‡å€¼è¿œä½äºå…¶çœŸå®å¹³å‡å€¼ã€‚ $ hat(mu)_(a^ast, N_(a^ast) (t-1)) < mu^ast - sqrt((2 log t)/(N_(a^ast) (t-1))) $
+ æ¬¡ä¼˜è‡‚è¢«é«˜ä¼° (Optimistic estimate for sub-optimal arm): æ¬¡ä¼˜è‡‚$i$çš„ç»éªŒå¹³å‡å€¼è¿œé«˜äºå…¶çœŸå®å¹³å‡å€¼ã€‚ $ hat(mu)_(a^ast, N_(a^ast) (t-1)) < mu^ast + sqrt((2 log t)/(N_(i) (t-1))) $
+ è‡‚$i$çš„æ‹‰åŠ¨æ¬¡æ•°è¿˜ä¸å¤Ÿå¤š (Arm $i$ is not pulled enough times): æ­¤æ—¶ç½®ä¿¡åŒºé—´ä»ç„¶å¾ˆå¤§ï¼Œå¯¼è‡´å…¶çœŸå®å‡å€¼å’Œæœ€ä¼˜å‡å€¼çš„å·®è·è¢«ç½®ä¿¡åŒºé—´è¦†ç›–ã€‚ $ mu^ast - mu_i <= 2 sqrt((2 log t)/(N_i (t-1))) $

å‡è®¾ä¸‰ç§æƒ…å†µéƒ½æ²¡å‘ç”Ÿï¼Œå°†ä»–ä»¬ç»“åˆèµ·æ¥å¾—åˆ°ï¼š
$ "UCB"_(a^ast) (t) = hat(mu)_(a^ast, N_(a^ast) (t-1)) + sqrt((2 log t)/(N_(a^ast) (t-1))) >= mu^ast $
$ "UCB"_i (t) = hat(mu)_(i, N_i (t-1)) + sqrt((2 log t)/(N_i (t-1))) <= mu_i + 2 sqrt((2 log t)/(N_i (t-1)))<  mu^ast $
è¿™å°±å¾—å‡ºäº†$"UCB"_i (t) < "UCB"_(a^ast) (t)$ï¼Œä¸è‡‚$i$è¢«é€‰ä¸­çš„å‰æç›¸çŸ›ç›¾ã€‚å› æ­¤ï¼Œåªè¦è‡‚$i$è¢«é€‰ä¸­ï¼Œä¸Šè¿°ä¸‰ç§æƒ…å†µå¿…æœ‰å…¶ä¸€ä¸ºçœŸã€‚

ç°åœ¨æˆ‘ä»¬æ¥åˆ†æè¿™ä¸‰ç§æƒ…å†µå‘ç”Ÿçš„æ¬¡æ•°ï¼š

- å¯¹äºæƒ…å†µ 3ï¼Œæˆ‘ä»¬å¯¹å…¶è¿›è¡Œä»£æ•°å˜æ¢ï¼š$ Delta_i <= 2 sqrt((2 log t)/(N_i (t-1))) ==>Delta_i^2 <= (8 log t)/(N_i (t-1)) ==> N_i (t-1)<= (8 log t)/(Delta_i^2) $ ç”±äº$t<=T$ï¼Œæ‰€ä»¥è‡‚$i$å› ä¸ºè¿™ç§æƒ…å†µè¢«é€‰æ‹©çš„æ¬¡æ•°ä¸ä¼šè¶…è¿‡$(8 log T)/(Delta_i^2)$ã€‚æˆ‘ä»¬ç§°è¿™ä¸ªé˜ˆå€¼ä¸º$l_i = ceil((8 log T)/(Delta_i^2))$ã€‚
- å¯¹äºæƒ…å†µ 1 å’Œ 2ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ éœå¤«ä¸ä¸ç­‰å¼ (Hoeffding's Inequality) æ¥çº¦æŸå®ƒä»¬å‘ç”Ÿçš„æ¦‚ç‡ã€‚ä»¤$epsilon = sqrt((2 log t)/s)$ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š$ P(hat(x_s) - x > sqrt((2 log t)/s))<= e^(-2 s ((2 log t)/s))= e^(-4 log t) = t^(-4) $ è¿™ä¸ªæ¦‚ç‡éå¸¸å°ã€‚è‡‚$i$åœ¨$t$æ—¶åˆ»å› ä¸ºæƒ…å†µ 1 æˆ– 2 è¢«é€‰æ‹©çš„æ¬¡æ•°ï¼Œå…¶æœŸæœ›å¯ä»¥è¢«ä¸€ä¸ªå¾ˆå°çš„ã€å¯æ±‚å’Œçš„åºåˆ—çº¦æŸã€‚åœ¨æ‰€æœ‰è½®æ¬¡ä¸­ï¼Œç”±äºè¿™ä¸¤ç§â€œåäº‹ä»¶â€è€Œé€‰æ‹©è‡‚$i$çš„æ€»æ¬¡æ•°çš„æœŸæœ›æ˜¯ä¸€ä¸ªå¸¸æ•°ã€‚ä¾‹å¦‚ï¼Œ$sum_(t=1)^infinity t^(-4)= (pi^4)/(90) - 1$

ç»¼åˆæ¥çœ‹ï¼Œè‡‚$i$è¢«é€‰æ‹©çš„æ€»æ¬¡æ•°çš„æœŸæœ›$bb(E) [N_i (T)]$ä¸»è¦ç”±æƒ…å†µ 3 å†³å®šã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ªä¸Šç•Œï¼š
$ bb(E)[N_i (T)] <= (8 log T)/(Delta_i^2) + C $
å…¶ä¸­$C$æ˜¯ä¸€ä¸ªä¸ä¾èµ–äº$T$çš„å°å¸¸æ•°ï¼ˆæ¥è‡ªåˆå§‹æ‹‰åŠ¨å’Œåäº‹ä»¶çš„æ¬¡æ•°ï¼‰ã€‚åœ¨åˆ†ææ¸è¿‘è¡Œä¸ºæ—¶ï¼Œæˆ‘ä»¬ä¸»è¦å…³æ³¨$log T$é¡¹ã€‚

ç°åœ¨æˆ‘ä»¬æœ‰äº†æ¯ä¸ªæ¬¡ä¼˜è‡‚è¢«é€‰æ‹©æ¬¡æ•°çš„æœŸæœ›ä¸Šç•Œã€‚æˆ‘ä»¬å›åˆ°æ€»é—æ†¾çš„å…¬å¼ï¼Œå¹¶ä½¿ç”¨ æŸ¯è¥¿-æ–½ç“¦èŒ¨ä¸ç­‰å¼ (Cauchy-Schwarz Inequality)ã€‚

æ€»é—æ†¾çš„æœŸæœ›ä¸º$R_T = sum_(i=1)^K bb(E)[N_i (T)] Delta_i$ã€‚
$ R_T^2 = (sum_(i=1)^K bb(E)[N_i (T)]Delta_i)^2 = (sum_(i=1)^K sqrt(bb(E)[N_i (T)]) dot sqrt(bb(E) [N_i (T)]) Delta_i)^2 $
æ ¹æ®æŸ¯è¥¿-æ–½ç“¦èŒ¨ä¸ç­‰å¼å¾—åˆ°ï¼š
$ R_T^2 <= (sum_(i=1)^K (sqrt(bb(E)[N_i (T)]))^2)dot (sum_(i=1)^K (sqrt(bb(E) [N_i (T)])Delta_i)^2) $
$ R_T^2<=(sum_(i=1)^K bb(E)[N_i (T)])dot (sum_(i=1)^K bb(E)[N_i (T)] Delta_i^2) $

ç¬¬ä¸€é¡¹ï¼š æ‰€æœ‰è‡‚è¢«é€‰æ‹©æ¬¡æ•°çš„æœŸæœ›ä¹‹å’Œå°±æ˜¯æ€»è¯•éªŒæ¬¡æ•°$T$:
$ sum_(i=1)^K bb(E) [N_i (T)] = bb(E) [sum_(i=1)^K N_i (T)] = T $
ç¬¬äºŒé¡¹ï¼š æˆ‘ä»¬ä½¿ç”¨ç¬¬ä¸€æ­¥å¾—åˆ°çš„ç»“è®º$bb(E)[N_i (T)]<= (8 log T)/(Delta_i^2) +C$ã€‚
$ sum_(i=1)^K bb(E)[N_i (T)]Delta_i^2 = bb(E)[N_(a^ast)]Delta_(a^ast)^2 + sum_(i!= a^ast) bb(E)[N_i (T)]Delta_i^2 $
ç”±äº$Delta_(a^ast)=0$ï¼Œç¬¬ä¸€é¡¹ä¸º0.ç”±äºæ€»å…±æœ‰$K-1$ä¸ªæ¬¡ä¼˜è‡‚ï¼Œå¹¶ä¸”$Delta_i in [0,1]$ï¼Œæ‰€ä»¥$Delta_i^2 <= 1$ã€‚
$ <= (K-1)(8 log T) + C sum_(i!= a^ast) Delta_i^2 <= 8 K log T + C K $
æ‰€ä»¥ï¼Œè¿™ä¸€é¡¹çš„ä¸Šç•Œæ˜¯$O(K log T)$ã€‚ 
å°†è¿™ä¸¤é¡¹çš„ç»“æœä»£å…¥å¾—åˆ°ï¼š
$ R_T^2 <= T dot O(K log T)=O(K T log T) $
ç”±æ­¤å¾—åˆ°ï¼š
$ R_T <= O(sqrt(K T log T)) $

=== 10.æ±¤æ™®æ£®é‡‡æ ·ç®—æ³•

== äºŒã€å¯¹æŠ—æ€§å¤šè‡‚è€è™æœº

== ä¸‰ã€å¤šè‡‚è€è™æœºçš„åº”ç”¨